<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.bitflash.dao.UserBuyDao">

    <select id="getBuyMessage" resultType="cn.bitflash.trade.UserBuyMessageBean">
        select
        ub.* ,ui.nickname
        from user_buy ub left join user_info ui on(ub.uid=ui.uid)
        where ub.uid!=#{uid} and state ='0'
        limit #{pages},6
    </select>

    <select id="getNumToPaging" resultType="java.lang.Integer">
        select count(0) from user_buy where state = '1'

    </select>

    <select id="selectBuyList" resultType="cn.bitflash.trade.UserBuyBean">
        select
        ub.* ,ui.nickname,uh.sell_uid,uh.purchase_uid,uh.purchase_state,uh.sell_state
        from user_buy ub left join user_info ui on(ub.uid=ui.uid)
        left join user_buy_history uh on ub.id = uh.user_buy_id
        where ub.uid=#{uid} and ub.state !='6' and ub.state !='0' and ub.state !='9' or uh.sell_uid=#{uid} and uh.sell_state !='6' and uh.sell_state !='0' and uh.sell_state !='9'
    </select>


    <select id="selectAppealList" resultType="cn.bitflash.trade.UserBuyBean">
        select
        ub.* ,ui.nickname,uh.sell_uid,uh.purchase_uid,uh.purchase_state,uh.sell_state
        from user_buy ub left join user_info ui on(ub.uid=ui.uid)
        left join user_buy_history uh on ub.id = uh.user_buy_id
        where ub.uid=#{uid} and ub.state = '9' or uh.sell_uid=#{uid} and ub.state='9'
    </select>

</mapper>